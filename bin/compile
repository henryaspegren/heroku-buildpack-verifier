#!/bin/sh

indent() {
  sed -u 's/^/       /'
}

# set a key HERE
key='production_release'

echo '-----> Found a identifier.txt'
echo "-----> key is $key"
echo "arg 1 is $1"
echo "arg 2 is $2"
echo "arg 3 is $3"

cat $3
cat $3/VERIFIER_KEY

# if identifier.txt does not contain the key, abort the build
if grep -q $key $1/identifier.txt; then
  echo "Key found. Production build authorized"
  exit 0

else
  echo "identifier.txt does not have the required key to push to production. Build failed"
  exit 1
fi

# replace identifier with goodbye in a new file
cat $1/identifier.txt | sed -e "s/[Hh]ello/Goodbye/g" > $1/goodbye.txt
